<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <meta name="description" content="A privacy-first, browser-based data cleaning toolkit that runs offline using WebAssembly (Wasm). Detect missing values, duplicates, and clean CSV data with transparent algorithms.">
	    <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1">
	    <meta name="theme-color" content="#000000">
	    <title>Data Cleaning Toolkit | Calum Kerr</title>
	    <link rel="canonical" href="https://www.calumkerr.com/app">
	    <meta property="og:type" content="website">
	    <meta property="og:title" content="Data Cleaning Toolkit | Calum Kerr">
	    <meta property="og:site_name" content="Calum Kerr">
	    <meta property="og:locale" content="en_GB">
	    <meta property="og:description" content="Privacy-first CSV cleaning in your browser. Transparent algorithms. Offline-first via WebAssembly.">
	    <meta property="og:url" content="https://www.calumkerr.com/app">
	    <meta property="og:image" content="https://www.calumkerr.com/android-chrome-512x512.png">
	    <meta name="twitter:card" content="summary">
	    <meta name="twitter:title" content="Data Cleaning Toolkit | Calum Kerr">
	    <meta name="twitter:description" content="Privacy-first CSV cleaning in your browser. Transparent algorithms. Offline-first via WebAssembly.">
	    <meta name="twitter:image" content="https://www.calumkerr.com/android-chrome-512x512.png">
	    <link rel="icon" href="/favicon.ico">
	    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
	    <script type="application/ld+json">{"@context":"https://schema.org","@type":"SoftwareApplication","name":"Data Cleaning Toolkit","applicationCategory":"BusinessApplication","operatingSystem":"Web","description":"A privacy-first, browser-based data cleaning toolkit that runs offline using WebAssembly (Wasm). Detect missing values, duplicates, and clean CSV data with transparent algorithms.","url":"https://www.calumkerr.com/app","creator":{"@type":"Person","name":"Calum Kerr","url":"https://www.calumkerr.com"},"offers":{"@type":"Offer","price":"0","priceCurrency":"GBP"}}</script>
	    <link rel="manifest" href="/manifest.json">
    <style>
        body{font-family:Arial,sans-serif;max-width:1200px;margin:0 auto;padding:20px;background:#f9f9f9;color:#333}
        h1{margin-top:0;text-align:center;color:#333}
        .welcome-section{text-align:center;margin:40px 0;padding:30px;background:white;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .welcome-section h2{margin-bottom:30px;color:#333;font-size:24px}
        .cta-buttons{display:flex;justify-content:center;gap:20px;flex-wrap:wrap;margin-top:30px}
        .cta-button{padding:20px 30px;background:#333;color:white;border:none;border-radius:8px;cursor:pointer;font-size:18px;min-width:200px;transition:background 0.3s}
        .cta-button:hover{background:#555}
        .cta-button.coming-soon{background:#ccc;cursor:not-allowed}
        .cta-button.coming-soon:hover{background:#bbb}
        .structured-section{display:none;margin:20px 0;padding:20px;background:white;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .section-title{margin-top:0;color:#333;border-bottom:2px solid #333;padding-bottom:10px}
        .upload-area{border:2px dashed #ccc;border-radius:8px;padding:40px;text-align:center;margin:20px 0;transition:border-color 0.3s}
        .upload-area.drag-over{border-color:#333;background:#f0f0f0}
        .upload-options{display:flex;justify-content:center;gap:15px;margin:20px 0;flex-wrap:wrap}
        .upload-option{padding:12px 20px;background:#e0e0e0;border:none;border-radius:4px;cursor:pointer}
        .upload-option:hover{background:#d0d0d0}
        textarea{width:100%;padding:15px;border:1px solid #ddd;border-radius:4px;font-family:monospace;font-size:14px;box-sizing:border-box;min-height:200px;resize:vertical}
        .profile-section{display:none;margin:20px 0;padding:20px;background:white;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .profile-details{margin:15px 0;padding:15px;background:#f8f9fa;border-radius:4px;border-left:4px solid #007bff}
        .issues-list{margin:15px 0;padding:15px;background:#fff3cd;border-radius:4px;border-left:4px solid #ffc107}
        .cleaning-section{display:none;margin:20px 0;padding:20px;background:white;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .progress-container{margin:20px 0;background:#f0f0f0;border-radius:4px;height:30px;overflow:hidden}
        .progress-bar{height:100%;background:#28a745;width:0%;transition:width 0.3s}
        .settings-section{margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px}
        .setting-option{margin:10px 0}
        .result-section{display:none;margin:20px 0;padding:20px;background:white;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}
        .success-message{text-align:center;padding:30px;background:#d4edda;border-radius:8px;color:#155724;margin:20px 0}
        .hidden{display:none}
        @media (max-width:768px){body{padding:10px}.cta-buttons{flex-direction:column;align-items:center}.cta-button{width:100%;max-width:300px}}
    </style>
</head>
<body>
    <h1>Data Cleaning Toolkit</h1>
    <div class="welcome-section" id="welcomeSection">
        <h2>Choose Your Data Type</h2>
        <p>Select the type of data you want to clean:</p>
        <div class="cta-buttons">
            <button class="cta-button" onclick="selectStructured()">Structured Data</button>
            <button class="cta-button coming-soon" onclick="showComingSoon('Semi-Structured')">Semi-Structured (Coming Soon)</button>
            <button class="cta-button coming-soon" onclick="showComingSoon('Unstructured')">Unstructured (Coming Soon)</button>
        </div>
    </div>
    <div class="structured-section" id="structuredSection">
        <h2 class="section-title">Structured Data Cleaning</h2>
        <p>Upload your CSV file to begin the automated cleaning process.</p>

        <div class="upload-area" id="uploadArea" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" ondrop="handleDrop(event)">
            <h3>Upload CSV File</h3>
            <p>Drag and drop your file here, or paste CSV data below</p>
            <div class="upload-options">
                <button class="upload-option" onclick="document.getElementById('fileInput').click()">Choose File</button>
                <button class="upload-option" onclick="pasteFromClipboard()">Paste from Clipboard</button>
            </div>
            <input type="file" id="fileInput" accept=".csv" onchange="handleFileUpload(event)" style="display: none;">
        </div>
        <textarea id="csvInput" placeholder="Paste your CSV data here..."></textarea>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="beginProfiling()" id="profileBtn" disabled>Analyze & Profile Data</button>
        </div>
    </div>
    <div class="profile-section" id="profileSection">
        <h2 class="section-title">Data Profile</h2>
        <p>Detailed analysis of your uploaded data:</p>
        <div class="profile-details" id="profileDetails"></div>
        <div class="issues-list" id="issuesList"></div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="startAutoCleaning()">Start Auto-Cleaning</button>
        </div>
    </div>
    <div class="cleaning-section" id="cleaningSection">
        <h2 class="section-title">Auto-Cleaning in Progress</h2>
        <p>Your data is being automatically cleaned based on the detected issues...</p>
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div id="progressText" style="text-align: center; margin: 10px 0;">Initializing...</div>
        <div class="settings-section">
            <h3>Cleaning Settings</h3>
            <div class="setting-option">
                <label>
                    <input type="checkbox" id="uppercaseSetting" checked> Convert to Uppercase (default)
                </label>
            </div>
            <div class="setting-option">
                <label>
                    <input type="checkbox" id="removeDuplicatesSetting" checked> Remove Duplicates
                </label>
            </div>
            <div class="setting-option">
                <label>
                    <input type="checkbox" id="trimWhitespaceSetting" checked> Trim Whitespace
                </label>
            </div>
            <div class="setting-option">
                <label>
                    <input type="checkbox" id="standardizeNullsSetting" checked> standardise Null Values
                </label>
            </div>
        </div>
    </div>
    <div class="result-section" id="resultSection">
        <h2 class="section-title">Cleaning Complete!</h2>
        <div class="success-message">
            <h3>Your data has been successfully cleaned</h3>
            <p>The cleaned file has been automatically downloaded to your device.</p>
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="startNewSession()">Clean Another File</button>
        </div>
    </div>
    <script src="algorithms.js"></script>
    <script>
        let wasmModule=null;let wasmReady=false;let uploadCSV='';let cleanedCSV='';
        AlgorithmsModule().then(module=>{wasmModule=module;wasmReady=true;});
        function showComingSoon(type){alert(`${type} data cleaning is coming soon! Please select "Structured Data" for now.`);}
        function selectStructured(){document.getElementById('welcomeSection').classList.add('hidden');document.getElementById('structuredSection').style.display='block';}
        function handleDragOver(e){e.preventDefault();document.getElementById('uploadArea').classList.add('drag-over');}
        function handleDragLeave(e){e.preventDefault();document.getElementById('uploadArea').classList.remove('drag-over');}
        function handleDrop(e){
            e.preventDefault();document.getElementById('uploadArea').classList.remove('drag-over');
            const files=e.dataTransfer.files;
            if(files.length>0){
                const file=files[0];
                if(file.name.endsWith('.csv')){
                    const reader=new FileReader();
                    reader.onload=function(e){uploadCSV=e.target.result;document.getElementById('csvInput').value=uploadCSV;document.getElementById('profileBtn').disabled=false;};
                    reader.readAsText(file);
                }else{alert('Please upload a CSV file.');}
            }
        }
        function handleFileUpload(e){
            const file=e.target.files[0];
            if(file){
                const reader=new FileReader();
                reader.onload=function(e){uploadCSV=e.target.result;document.getElementById('csvInput').value=uploadCSV;document.getElementById('profileBtn').disabled=false;};
                reader.readAsText(file);
            }
        }
        async function pasteFromClipboard(){
            try{
                const text=await navigator.clipboard.readText();
                if(text){uploadCSV=text;document.getElementById('csvInput').value=uploadCSV;document.getElementById('profileBtn').disabled=false;}
            }catch(err){
                console.error('Failed to read clipboard contents: ',err);
                alert('Could not access clipboard. Please paste directly into the text area.');
            }
        }
        function beginProfiling(){
            if(!uploadCSV){alert('Please upload or paste CSV data first.');return;}
            document.getElementById('structuredSection').classList.add('hidden');
            document.getElementById('profileSection').style.display='block';
            performProfiling();
        }
        async function performProfiling(){
            const API_URL=window.location.origin;
            let results={};
            if(wasmReady){
                results.rows=wasmModule.ccall('parseCSV','number',['string'],[uploadCSV]);
                results.missing=wasmModule.ccall('detectMissing','number',['string'],[uploadCSV]);
                results.duplicates=wasmModule.ccall('detectDuplicates','number',['string'],[uploadCSV]);
                results.whitespace=wasmModule.ccall('detectWhitespace','number',['string'],[uploadCSV]);
                try{results.nulls=wasmModule.ccall('detectNullValues','number',['string'],[uploadCSV]);}
                catch(e){
                    const nullRes=await fetch(API_URL+'/api/detect-null-values',{method:'POST',headers:{'Content-Type':'text/plain'},body:uploadCSV});
                    const nullData=await nullRes.json();
                    results.nulls=nullData.cellsWithNullValues||0;
                }
            }else{
                const parseRes=await fetch(API_URL+'/api/parse',{method:'POST',body:uploadCSV});
                const parseData=await parseRes.json();
                results.rows=parseData.rows;
                const missingRes=await fetch(API_URL+'/api/detect-missing',{method:'POST',body:uploadCSV});
                const missingData=await missingRes.json();
                results.missing=missingData.missing;
                const dupRes=await fetch(API_URL+'/api/detect-duplicates',{method:'POST',body:uploadCSV});
                const dupData=await dupRes.json();
                results.duplicates=dupData.duplicates;
                const wsRes=await fetch(API_URL+'/api/detect-whitespace',{method:'POST',body:uploadCSV});
                const wsData=await wsRes.json();
                results.whitespace=wsData.cellsWithWhitespace||0;
                const nullRes=await fetch(API_URL+'/api/detect-null-values',{method:'POST',body:uploadCSV});
                const nullData=await nullRes.json();
                results.nulls=nullData.cellsWithNullValues||0;
            }
            displayProfileDetails(results);
        }
        function displayProfileDetails(results){
            const profileDiv=document.getElementById('profileDetails');
            const issuesDiv=document.getElementById('issuesList');
            profileDiv.innerHTML=`<h3>Data Summary</h3><p><strong>Total Rows:</strong> ${results.rows||0}</p><p><strong>Total Columns:</strong> ${getColumnCount(uploadCSV)}</p><p><strong>File Size:</strong> ${(new Blob([uploadCSV]).size/1024).toFixed(2)} KB</p>`;
            let issuesHtml='<h3>Detected Issues</h3><ul>';
            let issueCount=0;
            if(results.missing>0){issuesHtml+=`<li>Missing values: ${results.missing} cells</li>`;issueCount++;}
            if(results.duplicates>0){issuesHtml+=`<li>Duplicate rows: ${results.duplicates} rows</li>`;issueCount++;}
            if(results.whitespace>0){issuesHtml+=`<li>Whitespace issues: ${results.whitespace} cells</li>`;issueCount++;}
            if(results.nulls>0){issuesHtml+=`<li>Null/empty values: ${results.nulls} cells</li>`;issueCount++;}
            if(issueCount===0){issuesHtml+='<li>No issues detected - your data looks clean!</li>';}
            issuesHtml+='</ul>';
            issuesDiv.innerHTML=issuesHtml;
        }
        function getColumnCount(csv){if(!csv)return 0;const firstLine=csv.split('\n')[0];if(!firstLine)return 0;return firstLine.split(',').length;}
        function startAutoCleaning(){document.getElementById('profileSection').classList.add('hidden');document.getElementById('cleaningSection').style.display='block';performAutoCleaning();}
        async function performAutoCleaning(){
            const API_URL=window.location.origin;
            let current=uploadCSV;
            let progress=0;
            const totalSteps=5;
            function updateProgress(step,message){progress=Math.floor((step/totalSteps)*100);document.getElementById('progressBar').style.width=progress+'%';document.getElementById('progressText').textContent=message;}
            updateProgress(0,'Starting auto-cleaning...');
            try{
                updateProgress(1,'Removing duplicates...');
                if(document.getElementById('removeDuplicatesSetting').checked){
                    if(wasmReady){current=wasmModule.ccall('cleanDataString','string',['string'],[current]);}
                    else{const res=await fetch(API_URL+'/api/clean',{method:'POST',headers:{'Content-Type':'text/plain'},body:current});const data=await res.json();current=data.cleaned||current;}
                }
                updateProgress(2,'Trimming whitespace...');
                if(document.getElementById('trimWhitespaceSetting').checked){
                    if(wasmReady){current=wasmModule.ccall('trimWhitespaceString','string',['string'],[current]);}
                    else{const res=await fetch(API_URL+'/api/trim-whitespace',{method:'POST',headers:{'Content-Type':'text/plain'},body:current});const data=await res.json();current=data.cleaned||current;}
                }
                updateProgress(3,'Standardizing null values...');
                if(document.getElementById('standardizeNullsSetting').checked){
                    if(wasmReady){current=wasmModule.ccall('standardiseNullValueString','string',['string'],[current]);}
                    else{const res=await fetch(API_URL+'/api/standardise-null-values',{method:'POST',headers:{'Content-Type':'text/plain'},body:current});const data=await res.json();current=data.cleaned||current;}
                }
                updateProgress(4,'Converting to uppercase...');
                if(document.getElementById('uppercaseSetting').checked){
                    if(wasmReady){current=wasmModule.ccall('toUpperCaseString','string',['string'],[current]);}
                    else{const res=await fetch(API_URL+'/api/to-uppercase',{method:'POST',headers:{'Content-Type':'text/plain'},body:current});const data=await res.json();current=data.cleaned||current;}
                }
                updateProgress(5,'Finalising cleaned data...');
                cleanedCSV=current;
                setTimeout(()=>{document.getElementById('cleaningSection').classList.add('hidden');document.getElementById('resultSection').style.display='block';triggerDownload();},1000);
            }catch(error){
                console.error('Error during auto-cleaning:',error);
                alert('An error occurred during the cleaning process. Please try again.');
                updateProgress(5,'Error occurred - cleaning incomplete');
            }
        }
        function triggerDownload(){
            const blob=new Blob([cleanedCSV],{type:'text/csv'});
            const url=window.URL.createObjectURL(blob);
            const a=document.createElement('a');
            a.href=url;a.download='cleaned_data.csv';
            document.body.appendChild(a);a.click();document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        function startNewSession(){
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('cleaningSection').classList.add('hidden');
            document.getElementById('profileSection').classList.add('hidden');
            document.getElementById('structuredSection').classList.add('hidden');
            document.getElementById('welcomeSection').classList.remove('hidden');
            document.getElementById('csvInput').value='';
            document.getElementById('fileInput').value='';
            uploadCSV='';cleanedCSV='';
            document.getElementById('uppercaseSetting').checked=true;
            document.getElementById('removeDuplicatesSetting').checked=true;
            document.getElementById('trimWhitespaceSetting').checked=true;
            document.getElementById('standardizeNullsSetting').checked=true;
        }
        if('serviceWorker'in navigator){navigator.serviceWorker.register('service-worker.js').then(registration=>{console.log('Service Worker registered with scope:',registration.scope);}).catch(error=>{console.log('Service Worker registration failed:',error);});}
    </script>
</body>
</html>